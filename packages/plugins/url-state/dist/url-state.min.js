var BWUrlState=(()=>{var m=Object.defineProperty;var y=Object.getOwnPropertyDescriptor;var P=Object.getOwnPropertyNames;var F=Object.prototype.hasOwnProperty;var b=(n,e)=>{for(var r in e)m(n,r,{get:e[r],enumerable:!0})},v=(n,e,r,u)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of P(e))!F.call(n,s)&&s!==r&&m(n,s,{get:()=>e[s],enumerable:!(u=y(e,s))||u.enumerable});return n};var x=n=>v(m({},"__esModule",{value:!0}),n);var E={};b(E,{UrlStatePlugin:()=>h,default:()=>h});var L={prefix:"",pushState:!0,syncSort:!0,syncFilter:!0,syncSearch:!0},h={name:"url-state",init(n){let{eventBus:e,table:r,options:u}=n;if(!r){console.error("UrlStatePlugin: table is undefined");return}if(!e){console.error("UrlStatePlugin: eventBus is undefined");return}let s={...L,...u},S=!1,f=null;function i(o){return new URLSearchParams(window.location.search).get(s.prefix+o)}function w(o){let t=new URLSearchParams(window.location.search);for(let[U,p]of Object.entries(o)){let g=s.prefix+U;p==null||p===""?t.delete(g):t.set(g,String(p))}let a=t.toString(),c=a?`${window.location.pathname}?${a}`:window.location.pathname;s.pushState?window.history.pushState({},"",c):window.history.replaceState({},"",c)}function l(){if(S)return;let o=r.getState(),t={};s.syncSort&&(o.sort&&o.sort.column&&o.sort.direction?t.sort=`${o.sort.column}:${o.sort.direction}`:t.sort=null),(s.syncSearch||s.syncFilter)&&(o.globalFilter?t.search=o.globalFilter:t.search=null),w(t),e&&e.emit&&e.emit("urlstate:update",{updates:t})}function d(){S=!0;let o=!1;try{if(s.syncSort){let t=i("sort");if(t&&t.includes(":")){let[a,c]=t.split(":");a&&(c==="asc"||c==="desc")&&(r.sort(a,c),o=!0)}}if(s.syncSearch||s.syncFilter){let t=i("search");if(t){r.filter(t);let a=document.querySelector(".bw-datatable__search");a&&(a.value=t),o=!0}}o&&e&&e.emit&&e.emit("urlstate:restore",{sort:i("sort"),search:i("search")})}catch(t){console.error("UrlStatePlugin: Error restoring state",t)}S=!1}return e.on("sort",l),e.on("sort:after",l),e.on("filter",l),e.on("filter:after",l),e.on("filter:clear",l),f=()=>{d()},window.addEventListener("popstate",f),setTimeout(()=>{d()},0),r.getUrlState=()=>({sort:i("sort"),search:i("search")}),r.updateUrl=l,r.restoreFromUrl=d,{name:"url-state",updateUrl:l,restoreFromUrl:d,getUrlState:r.getUrlState,destroy(){f&&window.removeEventListener("popstate",f),delete r.getUrlState,delete r.updateUrl,delete r.restoreFromUrl}}}};return x(E);})();
BWUrlState=BWUrlState.UrlStatePlugin;
