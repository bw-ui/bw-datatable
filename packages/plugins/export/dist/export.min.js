var BWExport=(()=>{var O=Object.defineProperty;var L=Object.getOwnPropertyDescriptor;var U=Object.getOwnPropertyNames;var T=Object.prototype.hasOwnProperty;var k=(a,s)=>{for(var i in s)O(a,i,{get:s[i],enumerable:!0})},F=(a,s,i,b)=>{if(s&&typeof s=="object"||typeof s=="function")for(let p of U(s))!T.call(a,p)&&p!==i&&O(a,p,{get:()=>s[p],enumerable:!(b=L(s,p))||b.enumerable});return a};var H=a=>F(O({},"__esModule",{value:!0}),a);var N={};k(N,{ExportPlugin:()=>v,default:()=>v});var J={filename:"data",includeHeaders:!0,selectedOnly:!1,visibleOnly:!0,csvDelimiter:",",csvQuote:'"'},v={name:"export",init(a){let{eventBus:s,table:i,getState:b,options:p}=a,g={...J,...p};function x(o){return o.selectedOnly??g.selectedOnly?i.getSelected():i.getData()}function h(o){let e=o.visibleOnly??g.visibleOnly,t=b();return e?i.getVisibleColumns():t.columns}function y(o,e){let t=e.field||e.id;return t.includes(".")?t.split(".").reduce((n,c)=>n?.[c],o):o[t]}function j(o,e,t){let n=new Blob([o],{type:t}),c=URL.createObjectURL(n),r=document.createElement("a");r.href=c,r.download=e,r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(c)}function C(o,e,t){if(o==null)return"";let n=String(o);return n.includes(t)||n.includes(e)||n.includes(`
`)||n.includes("\r")?t+n.replace(new RegExp(t,"g"),t+t)+t:n}function S(o={}){let e={...g,...o},t=x(e),n=h(e);if(s.emit("export:before",{format:"json",rows:t,columns:n,options:e})===!1)return!1;let r=t.map(d=>{let m={};return n.forEach(u=>{m[u.id]=y(d,u)}),m}),f=JSON.stringify(r,null,2),l=`${e.filename}.json`;return j(f,l,"application/json"),s.emit("export:after",{format:"json",filename:l,rowCount:r.length}),!0}function E(o={}){let e={...g,...o},t=x(e),n=h(e),c=e.csvDelimiter,r=e.csvQuote;if(s.emit("export:before",{format:"csv",rows:t,columns:n,options:e})===!1)return!1;let l=[];if(e.includeHeaders){let u=n.map(w=>C(w.header||w.id,c,r));l.push(u.join(c))}t.forEach(u=>{let w=n.map(V=>C(y(u,V),c,r));l.push(w.join(c))});let d=l.join(`
`),m=`${e.filename}.csv`;return j(d,m,"text/csv;charset=utf-8;"),s.emit("export:after",{format:"csv",filename:m,rowCount:t.length}),!0}async function D(o={}){let e={...g,...o},t=x(e),n=h(e);if(s.emit("export:before",{format:"clipboard",rows:t,columns:n,options:e})===!1)return!1;let r=[];if(e.includeHeaders){let l=n.map(d=>d.header||d.id);r.push(l.join("	"))}t.forEach(l=>{let d=n.map(m=>{let u=y(l,m);return u==null?"":String(u)});r.push(d.join("	"))});let f=r.join(`
`);try{return await navigator.clipboard.writeText(f),s.emit("export:after",{format:"clipboard",rowCount:t.length}),!0}catch(l){return console.error("Failed to copy to clipboard:",l),!1}}function R(o={}){let e={...g,...o},t=x(e),n=h(e);return{rows:t,columns:n,data:t.map(c=>{let r={};return n.forEach(f=>{r[f.id]=y(c,f)}),r})}}return i.exportJSON=S,i.exportCSV=E,i.copyToClipboard=D,i.getExportData=R,{exportJSON:S,exportCSV:E,copyToClipboard:D,getExportData:R}},destroy(a){}};return H(N);})();
BWExport=BWExport.ExportPlugin;
