var O={filename:"export",includeHeaders:!0,selectedOnly:!1},S={name:"export",init(j){let{eventBus:c,table:r,options:w}=j;if(!r){console.error("ExportPlugin: table is undefined");return}let p={...O,...w};function f(t=!1){return t?r.getSelected?r.getSelected():[]:r.getFilteredData?r.getFilteredData():[]}function g(){return r.getState().columns||[]}function x(t,e,n){let l=new Blob([t],{type:n}),o=URL.createObjectURL(l),i=document.createElement("a");i.href=o,i.download=e,i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(o)}function m(t){if(t==null)return"";let e=String(t);return e.includes(",")||e.includes(`
`)||e.includes('"')?`"${e.replace(/"/g,'""')}"`:e}function h(t={}){let e={...p,...t},n=f(e.selectedOnly),l=g();if(n.length===0)return console.warn("ExportPlugin: No data to export"),!1;let o=[];if(e.includeHeaders){let d=l.map(a=>m(a.header||a.id));o.push(d.join(","))}for(let d of n){let a=l.map(u=>{let E=d[u.field||u.id];return m(E)});o.push(a.join(","))}let i=o.join(`
`),s=`${e.filename}.csv`;return x(i,s,"text/csv;charset=utf-8;"),c&&c.emit&&c.emit("export:csv",{count:n.length,filename:s}),!0}function y(t={}){let e={...p,...t},n=f(e.selectedOnly);if(n.length===0)return console.warn("ExportPlugin: No data to export"),!1;let l=JSON.stringify(n,null,2),o=`${e.filename}.json`;return x(l,o,"application/json"),c&&c.emit&&c.emit("export:json",{count:n.length,filename:o}),!0}function b(t={}){let e={...p,...t},n=f(e.selectedOnly),l=g();if(n.length===0)return console.warn("ExportPlugin: No data to copy"),!1;let o=[];e.includeHeaders&&o.push(l.map(s=>s.header||s.id).join("	"));for(let s of n){let d=l.map(a=>{let u=s[a.field||a.id];return u==null?"":String(u)});o.push(d.join("	"))}let i=o.join(`
`);return navigator.clipboard.writeText(i).then(()=>{c&&c.emit&&c.emit("export:clipboard",{count:n.length})}).catch(s=>{console.error("ExportPlugin: Failed to copy",s)}),!0}return r.exportCSV=h,r.exportJSON=y,r.copyToClipboard=b,{name:"export",exportCSV:h,exportJSON:y,copyToClipboard:b,destroy(){delete r.exportCSV,delete r.exportJSON,delete r.copyToClipboard}}}};export{S as ExportPlugin,S as default};
