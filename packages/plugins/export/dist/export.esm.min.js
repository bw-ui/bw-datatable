var V={filename:"data",includeHeaders:!0,selectedOnly:!1,visibleOnly:!0,csvDelimiter:",",csvQuote:'"'},S={name:"export",init(h){let{eventBus:p,table:a,getState:E,options:D}=h,f={...V,...D};function m(o){return o.selectedOnly??f.selectedOnly?a.getSelected():a.getData()}function g(o){let e=o.visibleOnly??f.visibleOnly,t=E();return e?a.getVisibleColumns():t.columns}function b(o,e){let t=e.field||e.id;return t.includes(".")?t.split(".").reduce((n,s)=>n?.[s],o):o[t]}function y(o,e,t){let n=new Blob([o],{type:t}),s=URL.createObjectURL(n),r=document.createElement("a");r.href=s,r.download=e,r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s)}function w(o,e,t){if(o==null)return"";let n=String(o);return n.includes(t)||n.includes(e)||n.includes(`
`)||n.includes("\r")?t+n.replace(new RegExp(t,"g"),t+t)+t:n}function O(o={}){let e={...f,...o},t=m(e),n=g(e);if(p.emit("export:before",{format:"json",rows:t,columns:n,options:e})===!1)return!1;let r=t.map(l=>{let d={};return n.forEach(i=>{d[i.id]=b(l,i)}),d}),u=JSON.stringify(r,null,2),c=`${e.filename}.json`;return y(u,c,"application/json"),p.emit("export:after",{format:"json",filename:c,rowCount:r.length}),!0}function v(o={}){let e={...f,...o},t=m(e),n=g(e),s=e.csvDelimiter,r=e.csvQuote;if(p.emit("export:before",{format:"csv",rows:t,columns:n,options:e})===!1)return!1;let c=[];if(e.includeHeaders){let i=n.map(x=>w(x.header||x.id,s,r));c.push(i.join(s))}t.forEach(i=>{let x=n.map(R=>w(b(i,R),s,r));c.push(x.join(s))});let l=c.join(`
`),d=`${e.filename}.csv`;return y(l,d,"text/csv;charset=utf-8;"),p.emit("export:after",{format:"csv",filename:d,rowCount:t.length}),!0}async function j(o={}){let e={...f,...o},t=m(e),n=g(e);if(p.emit("export:before",{format:"clipboard",rows:t,columns:n,options:e})===!1)return!1;let r=[];if(e.includeHeaders){let c=n.map(l=>l.header||l.id);r.push(c.join("	"))}t.forEach(c=>{let l=n.map(d=>{let i=b(c,d);return i==null?"":String(i)});r.push(l.join("	"))});let u=r.join(`
`);try{return await navigator.clipboard.writeText(u),p.emit("export:after",{format:"clipboard",rowCount:t.length}),!0}catch(c){return console.error("Failed to copy to clipboard:",c),!1}}function C(o={}){let e={...f,...o},t=m(e),n=g(e);return{rows:t,columns:n,data:t.map(s=>{let r={};return n.forEach(u=>{r[u.id]=b(s,u)}),r})}}return a.exportJSON=O,a.exportCSV=v,a.copyToClipboard=j,a.getExportData=C,{exportJSON:O,exportCSV:v,copyToClipboard:j,getExportData:C}},destroy(h){}};export{S as ExportPlugin,S as default};
